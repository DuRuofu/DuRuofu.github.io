

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/%E4%B8%AA%E4%BA%BA%E5%A4%B4%E5%83%8F%E6%97%A0%E8%83%8C%E6%99%AF.png">
  <link rel="icon" href="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/%E4%B8%AA%E4%BA%BA%E5%A4%B4%E5%83%8F%E6%97%A0%E8%83%8C%E6%99%AF.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="DuRuofu">
  <meta name="keywords" content="嵌入式,个人博客">
  
    <meta name="description" content="小程序 - 基础加强自定义组件自定义组件 - 组件的创建与引用1. 创建组件① 在项目的根目录中，鼠标右键，创建 components -&gt; test 文件夹② 在新建的 components -&gt; test 文件夹上，鼠标右键，点击“新建 Component”③ 键入组件的名称之后回车，会自动生成组件对应的 4 个文件，后缀名分别为 .js，.json， .wxml 和 .wxss注">
<meta property="og:type" content="article">
<meta property="og:title" content="微信小程序笔记 (7.微信小程序基础加强)">
<meta property="og:url" content="https://www.duruofu.xyz/2023/06/06/3.%E8%BD%AF%E4%BB%B6%E7%9B%B8%E5%85%B3/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%89%8D%E7%AB%AF/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/07.%E5%B0%8F%E7%A8%8B%E5%BA%8F%20-%20%E5%9F%BA%E7%A1%80%E5%8A%A0%E5%BC%BA/index.html">
<meta property="og:site_name" content="Duruofu&#39;s personal blog">
<meta property="og:description" content="小程序 - 基础加强自定义组件自定义组件 - 组件的创建与引用1. 创建组件① 在项目的根目录中，鼠标右键，创建 components -&gt; test 文件夹② 在新建的 components -&gt; test 文件夹上，鼠标右键，点击“新建 Component”③ 键入组件的名称之后回车，会自动生成组件对应的 4 个文件，后缀名分别为 .js，.json， .wxml 和 .wxss注">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.duruofu.xyz/img/index_img/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F.jpg">
<meta property="article:published_time" content="2023-06-06T03:46:53.000Z">
<meta property="article:modified_time" content="2024-01-05T05:38:22.414Z">
<meta property="article:author" content="DuRuofu">
<meta property="article:tag" content="微信小程序">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://www.duruofu.xyz/img/index_img/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F.jpg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>微信小程序笔记 (7.微信小程序基础加强) - Duruofu&#39;s personal blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/cust/custom.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.duruofu.xyz","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":80,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":true,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":5},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>DuRuofu</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/index_img/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="微信小程序笔记 (7.微信小程序基础加强)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        DuRuofu
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-06-06 11:46" pubdate>
          2023年6月6日 中午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          21k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          173 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">微信小程序笔记 (7.微信小程序基础加强)</h1>
            
              <p class="note note-info">
                
                  
                    本文最后更新于：5 分钟前
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h2 id="小程序-基础加强"><a href="#小程序-基础加强" class="headerlink" title="小程序 - 基础加强"></a>小程序 - 基础加强</h2><h3 id="自定义组件"><a href="#自定义组件" class="headerlink" title="自定义组件"></a>自定义组件</h3><h4 id="自定义组件-组件的创建与引用"><a href="#自定义组件-组件的创建与引用" class="headerlink" title="自定义组件 - 组件的创建与引用"></a>自定义组件 - 组件的创建与引用</h4><h5 id="1-创建组件"><a href="#1-创建组件" class="headerlink" title="1. 创建组件"></a>1. 创建组件</h5><p>① 在项目的根目录中，鼠标右键，创建 components -&gt; test 文件夹<br>② 在新建的 components -&gt; test 文件夹上，鼠标右键，点击“新建 Component”<br>③ 键入组件的名称之后回车，会自动生成组件对应的 4 个文件，后缀名分别为 .js，.json， .wxml 和 .wxss<br>注意：为了保证目录结构的清晰，建议把不同的组件，存放到单独目录中，例如：  </p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1650590028961.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h5 id="2-引用-组件"><a href="#2-引用-组件" class="headerlink" title="2.引用 组件"></a>2.引用 组件</h5><p>组件的引用方式分为“局部引用”和“全局引用”，顾名思义：<br> 局部引用：组件只能在当前被引用的页面内使用<br> 全局引用：组件可以在每个小程序页面中使用  </p>
<h5 id="3-局部引用组件"><a href="#3-局部引用组件" class="headerlink" title="3.局部引用组件"></a>3.局部引用组件</h5><p>在页面的 .json 配置文件中引用组件的方式，叫做“局部引用”。示例代码如下  ：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">//在页面的.json文件中，引入组件</span><br><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;usingComponents&quot;</span><span class="hljs-punctuation">:</span><br><span class="hljs-attr">&quot;my-test1&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;/components/test1/test1&quot;</span><span class="hljs-comment">//键值对（名称：路径）</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html">//在页面的.wxml文件中，使用组件<br><span class="hljs-tag">&lt;<span class="hljs-name">my-test1</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">my-test1</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h5 id="4-全局引用"><a href="#4-全局引用" class="headerlink" title="4.全局引用"></a>4.全局引用</h5><p>在 app.json 全局配置文件中引用组件的方式，叫做“全局引用”。示例代码如下：  </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">//在app.json文件中，引入组件</span><br><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;pages&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-comment">/*省略不必要的代码*/</span><span class="hljs-punctuation">]</span>，<br><span class="hljs-attr">&quot;window&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-comment">/*省略不必要的代码*/</span><span class="hljs-punctuation">&#125;</span>，<br><span class="hljs-attr">&quot;usingComponents&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;my-test2&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;/components/test2/test2&quot;</span><br>	<span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html">//在页面的.wxml文件中，使用组件<br><span class="hljs-tag">&lt;<span class="hljs-name">my-test2</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">my-test2</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h5 id="5-全局引用-VS-局部引用"><a href="#5-全局引用-VS-局部引用" class="headerlink" title="5.全局引用 VS 局部引用"></a>5.全局引用 VS 局部引用</h5><p>根据组件的使用频率和范围，来选择合适的引用方式：<br> 如果某组件在多个页面中经常被用到，建议进行“全局引用”<br> 如果某组件只在特定的页面中被用到，建议进行“局部引用”  </p>
<h5 id="6-组件和页面的区别"><a href="#6-组件和页面的区别" class="headerlink" title="6.组件和页面的区别"></a>6.组件和页面的区别</h5><p>从表面来看，组件和页面都是由 .js、.json、.wxml 和 .wxss 这四个文件组成的。但是，组件和页面的 .js 与<br>.json 文件有明显的不同：<br> 组件的 .json 文件中需要声明 “component”: true 属性<br> 组件的 .js 文件中调用的是 Component() 函数<br> 组件的事件处理函数需要定义到 methods 节点中  </p>
<h4 id="自定义组件-样式"><a href="#自定义组件-样式" class="headerlink" title="自定义组件 - 样式"></a>自定义组件 - 样式</h4><h5 id="1-组件样式隔离"><a href="#1-组件样式隔离" class="headerlink" title="1. 组件样式隔离"></a>1. 组件样式隔离</h5><p>默认情况下，自定义组件的样式只对当前组件生效，不会影响到组件之外的<br>UI 结构，如图所示：</p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1650606972182.png" srcset="/img/loading.gif" lazyload style="zoom:50%;">

<p> 组件 A 的样式不会影响组件 C 的样式<br> 组件 A 的样式不会影响小程序页面的样式<br> 小程序页面的样式不会影响组件 A 和 C 的样式<br>好处：<br>① 防止外界的样式影响组件内部的样式<br>② 防止组件的样式破坏外界的样式  </p>
<h5 id="2-组件样式隔离的注意点"><a href="#2-组件样式隔离的注意点" class="headerlink" title="2. 组件样式隔离的注意点"></a>2. 组件样式隔离的注意点</h5><p> app.wxss 中的全局样式对组件无效<br> 只有 class 选择器会有样式隔离效果，id 选择器、属性选择器、标签选择器不受样式隔离的影响<br>建议：在组件和引用组件的页面中建议使用 class 选择器，不要使用 id、属性、标签选择器！  </p>
<h5 id="3-修改组件的样式隔离选项"><a href="#3-修改组件的样式隔离选项" class="headerlink" title="3. 修改组件的样式隔离选项"></a>3. 修改组件的样式隔离选项</h5><p>默认情况下，自定义组件的样式隔离特性能够防止组件内外样式互相干扰的问题。但有时，我们希望在外界能<br>够控制组件内部的样式，此时，可以通过 styleIsolation 修改组件的样式隔离选项，用法如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//在组件的.js文件中新增如下配置</span><br><span class="hljs-title class_">Component</span> (<br><span class="hljs-attr">options</span>:<br><span class="hljs-attr">styleIsolation</span>:<span class="hljs-string">&#x27;isolated&#x27;</span><br>)<br><br><span class="hljs-comment">//或在组件的.json文件中新增如下配置</span><br>&#123;<br>  <span class="hljs-string">&quot;styleIsolation&quot;</span>:<span class="hljs-string">&quot;isolated&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="4-styleIsolation-的可选值"><a href="#4-styleIsolation-的可选值" class="headerlink" title="4. styleIsolation 的可选值"></a>4. styleIsolation 的可选值</h5><p><img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1650614712464.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="自定义组件-数据、方法和属性"><a href="#自定义组件-数据、方法和属性" class="headerlink" title="自定义组件 - 数据、方法和属性"></a>自定义组件 - 数据、方法和属性</h4><h5 id="1-data-数据"><a href="#1-data-数据" class="headerlink" title="1. data 数据"></a>1. data 数据</h5><p>在小程序组件中，用于组件模板渲染的私有数据，需要定义到 data 节点中，示例如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// components/text/test.js</span><br><span class="hljs-title class_">Component</span>(&#123;<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 组件的初始数据</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-attr">data</span>: &#123;<br>	<span class="hljs-attr">count</span>: <span class="hljs-number">0</span><br>  &#125;,<br>&#125;)<br></code></pre></td></tr></table></figure>

<h5 id="2-methods-方法"><a href="#2-methods-方法" class="headerlink" title="2. methods 方法"></a>2. methods 方法</h5><p>在小程序组件中，事件处理函数和自定义方法需要定义到 methods 节点中，示例代码如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-comment">//点击加一按钮的事件处理函数</span><br>    <span class="hljs-title function_">addCount</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>        <span class="hljs-attr">count</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">count</span> + <span class="hljs-number">1</span><br>      &#125;)<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_showCount</span>()<br>    &#125;,<br>    <span class="hljs-title function_">_showCount</span>(<span class="hljs-params"></span>)&#123;<span class="hljs-comment">//展示count的值的方法</span><br>      wx.<span class="hljs-title function_">showToast</span>(&#123;<br>        <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;count是&#x27;</span>+<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">count</span>,<br>        <span class="hljs-attr">icon</span>:<span class="hljs-string">&#x27;none&#x27;</span><br>      &#125;)<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<h5 id="3-properties-属性"><a href="#3-properties-属性" class="headerlink" title="3. properties 属性"></a>3. properties 属性</h5><p>在小程序组件中，properties 是组件的对外属性，用来接收外界传递到组件中的数据，示例代码如下  :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Component</span>(&#123;<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 组件的属性列表</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-attr">properties</span>: &#123;<br>    <span class="hljs-comment">//第一种方式：简化的方式（无法指定默认值）</span><br>    <span class="hljs-attr">max</span>:<span class="hljs-title class_">Number</span>,<br>    <span class="hljs-comment">//第一种方式：完整的的方式（可以指定默认值）</span><br>    <span class="hljs-attr">max</span>:&#123;<br>      <span class="hljs-attr">type</span>:<span class="hljs-title class_">Number</span>,<span class="hljs-comment">//数据类型</span><br>      <span class="hljs-attr">value</span>:<span class="hljs-number">10</span>   <span class="hljs-comment">//默认值为10</span><br>    &#125;<br>  &#125;,<br>&#125;<br><br><span class="hljs-comment">//结构文件就可以传递值,如下：          </span><br>&lt;my-test1 max=<span class="hljs-string">&quot;9&quot;</span>&gt;&lt;/my-test1&gt;                    <br></code></pre></td></tr></table></figure>

<h5 id="4-data-和-properties-的区别"><a href="#4-data-和-properties-的区别" class="headerlink" title="4.data 和 properties 的区别"></a>4.data 和 properties 的区别</h5><p>在小程序的组件中，properties 属性和 data 数据的用法相同，它们都是可读可写的，只不过：<br> data 更倾向于存储组件的私有数据<br> properties 更倾向于存储外界传递到组件中的数据  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">showInfo</span>(<span class="hljs-params"></span>)&#123;<span class="hljs-comment">//定义一个按钮点击打印数据的方法</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>)<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">properties</span>)<br>  <span class="hljs-comment">//上面两行的打印结果是一模一样的</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">properties</span>===<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>)<span class="hljs-comment">//结果为true，说明他们是一样的</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="5-使用-setData-修改-properties-的值"><a href="#5-使用-setData-修改-properties-的值" class="headerlink" title="5. 使用 setData 修改 properties 的值"></a>5. 使用 setData 修改 properties 的值</h5><p>由于 data 数据和 properties 属性在本质上没有任何区别，因此 properties 属性的值也可以用于页面渲染，<br>或使用 setData 为 properties 中的属性重新赋值，示例代码如下：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;-在结构文件中使用-&gt;<br><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>max的属性值是：&#123;&#123;max&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-comment">//点击加一按钮的事件处理函数</span><br>    <span class="hljs-title function_">addCount</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>        <span class="hljs-attr">count</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">count</span> + <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">max</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">properties</span>.<span class="hljs-property">max</span> +<span class="hljs-number">1</span><span class="hljs-comment">//同样可以修改max的值</span><br>      &#125;)<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_showCount</span>()<br>    &#125;,<br>  &#125;<br></code></pre></td></tr></table></figure>

<h4 id="自定义组件-数据监听器"><a href="#自定义组件-数据监听器" class="headerlink" title="自定义组件 - 数据监听器"></a>自定义组件 - 数据监听器</h4><p>数据监听器用于监听和响应任何属性和数据字段的变化，从而执行特定的操作。它的作用类似于 vue 中的<br>watch 侦听器。在小程序组件中，数据监听器的基本语法格式如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Component</span>(&#123;<br>  <span class="hljs-attr">observers</span>:&#123;<br>	<span class="hljs-string">&#x27;字段A,字段B&#x27;</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">字段A的新值，字段B的新值</span>)&#123;<br>     <span class="hljs-comment">//do something</span><br>	&#125;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<h5 id="2-数据监听器的基本用法"><a href="#2-数据监听器的基本用法" class="headerlink" title="2.. 数据监听器的基本用法"></a>2.. 数据监听器的基本用法</h5><p>ui结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html">//组件的UI结构如下<br><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>&#123;&#123;n1&#125;&#125;&#123;&#123;n2&#125;&#125;=&#123;&#123;sum&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span><span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;addN1&quot;</span>&gt;</span>n1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span><span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;addN2&quot;</span>&gt;</span>n2<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js">  <span class="hljs-attr">data</span>: &#123;<span class="hljs-comment">//数值节点</span><br>    <span class="hljs-attr">n1</span>:<span class="hljs-number">0</span>,<br>    <span class="hljs-attr">n2</span>:<span class="hljs-number">0</span>,<br>    <span class="hljs-attr">sum</span>:<span class="hljs-number">0</span><br>  &#125;<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-title function_">addN1</span>(<span class="hljs-params"></span>)&#123;<span class="hljs-comment">//方法节点</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>      <span class="hljs-attr">n1</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">n1</span>+<span class="hljs-number">1</span>  <br>      &#125;)<br>      &#125;,<br>    <span class="hljs-title function_">addN2</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>        <span class="hljs-attr">n2</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">n2</span>+<span class="hljs-number">1</span>  <br>        &#125;)<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">observers</span>:&#123;<span class="hljs-comment">//监听节点</span><br>    <span class="hljs-string">&#x27;n1,n2&#x27;</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">newn1,newn2</span>)&#123;<span class="hljs-comment">//利用数据监听器获取新值</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>        <span class="hljs-attr">sum</span>:newn1+newn2<span class="hljs-comment">//通过监听器自动计算n1+n2</span><br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="3-监听对象属性的变化"><a href="#3-监听对象属性的变化" class="headerlink" title="3.监听对象属性的变化"></a>3.监听对象属性的变化</h5><p>数据监听器支持监听对象中单个或多个属性的变化，示例语法如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Component</span>(&#123;<br><span class="hljs-attr">observers</span>:&#123;<br><span class="hljs-string">&#x27;对象.属性A,对象.属性B&#x27;</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">属性A的新值，属性B的新值</span>)&#123;<br>    <span class="hljs-comment">//触发此监听器的3种情况：</span><br>    <span class="hljs-comment">//【为属性A赋值】使用setData  设置this.data.对象.属性A时触发</span><br>    <span class="hljs-comment">//【为属性B赋值】使用setData  设置this.data.对象.属性B时触发</span><br>    <span class="hljs-comment">//【直接为对象赋值】使用setData设置this.data.对象 时触发</span><br>    <span class="hljs-comment">//do something...</span><br>	&#125;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<h5 id="4-数据监听案例（色值监听并渲染）"><a href="#4-数据监听案例（色值监听并渲染）" class="headerlink" title="4.数据监听案例（色值监听并渲染）"></a>4.数据监听案例（色值监听并渲染）</h5><p>效果：</p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1650623427659.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h5 id="2-渲染-UI-结构"><a href="#2-渲染-UI-结构" class="headerlink" title="2. 渲染 UI 结构"></a>2. 渲染 UI 结构</h5><p>结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color: rgb(&#123;&#123;fullcolor&#125;&#125;);&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;colorbox&quot;</span>&gt;</span>颜色值：&#123;&#123;fullcolor&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;default&quot;</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;changeR&quot;</span>&gt;</span>R<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;changeG&quot;</span>&gt;</span>G<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;warn&quot;</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;changeB&quot;</span>&gt;</span>B<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>&#123;&#123;rgb.r&#125;&#125;,&#123;&#123;rgb.g&#125;&#125;,&#123;&#123;rgb.b&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>样式：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.colorbox</span>&#123;<br>  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">200</span>rpx;<br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24</span>rpx;<br>  <span class="hljs-attribute">color</span>: wheat;<br>  <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span>rpx  <span class="hljs-number">0</span>rpx  <span class="hljs-number">2</span>rpx black;<br>  <span class="hljs-attribute">text-align</span>: center;<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="3-定义-button-的事件处理函数"><a href="#3-定义-button-的事件处理函数" class="headerlink" title="3. 定义 button 的事件处理函数"></a>3. 定义 button 的事件处理函数</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-title function_">changeR</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>        <span class="hljs-string">&#x27;rgb.r&#x27;</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">rgb</span>.<span class="hljs-property">r</span> +<span class="hljs-number">5</span> &gt;<span class="hljs-number">255</span> ? <span class="hljs-number">255</span> :<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">rgb</span>.<span class="hljs-property">r</span> +<span class="hljs-number">5</span> <br>      &#125;)<br>    &#125;,<br>    <span class="hljs-title function_">changeG</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>        <span class="hljs-string">&#x27;rgb.g&#x27;</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">rgb</span>.<span class="hljs-property">g</span> +<span class="hljs-number">5</span> &gt;<span class="hljs-number">255</span> ? <span class="hljs-number">255</span> :<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">rgb</span>.<span class="hljs-property">g</span> +<span class="hljs-number">5</span> <br>      &#125;)<br>    &#125;,<br>    <span class="hljs-title function_">changeB</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>        <span class="hljs-string">&#x27;rgb.b&#x27;</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">rgb</span>.<span class="hljs-property">b</span> +<span class="hljs-number">5</span> &gt;<span class="hljs-number">255</span> ? <span class="hljs-number">255</span> :<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">rgb</span>.<span class="hljs-property">b</span> +<span class="hljs-number">5</span> <br>      &#125;)<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<h5 id="4-监听对象中指定属性的变化"><a href="#4-监听对象中指定属性的变化" class="headerlink" title="4. 监听对象中指定属性的变化"></a>4. 监听对象中指定属性的变化</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">observers</span>:&#123;<br>    <span class="hljs-string">&#x27;rgb.r,rgb.g,rgb.b&#x27;</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">r,g,b</span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>        <span class="hljs-attr">fullcolor</span>:<span class="hljs-string">`<span class="hljs-subst">$&#123;r&#125;</span>,<span class="hljs-subst">$&#123;g&#125;</span>,<span class="hljs-subst">$&#123;b&#125;</span>`</span><br>      &#125;)<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<h5 id="5-监听对象中所有属性的变化"><a href="#5-监听对象中所有属性的变化" class="headerlink" title="5. 监听对象中所有属性的变化"></a>5. 监听对象中所有属性的变化</h5><p>如果某个对象中需要被监听的属性太多，为了方便，可以使用通配符 ** 来监听对象中所有属性的变化，示例<br>代码如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">observers</span>:&#123;<br>    <span class="hljs-string">&#x27;rgb.**&#x27;</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">obj</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>            <span class="hljs-attr">fullcolor</span>:<span class="hljs-string">`<span class="hljs-subst">$&#123;obj.r&#125;</span>,<span class="hljs-subst">$&#123;obj.g&#125;</span>,<span class="hljs-subst">$&#123;obj.b&#125;</span>`</span><br>        &#125;)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="自定义组件-纯数据字段"><a href="#自定义组件-纯数据字段" class="headerlink" title="自定义组件 - 纯数据字段"></a>自定义组件 - 纯数据字段</h4><h5 id="1-什么是纯数据字段"><a href="#1-什么是纯数据字段" class="headerlink" title="1.什么是纯数据字段"></a>1.什么是纯数据字段</h5><p>概念：纯数据字段指的是那些不用于界面渲染的 data 字段。<br>应用场景：例如有些情况下，某些 data 中的字段既不会展示在界面上，也不会传递给其他组件，仅仅在当前<br>组件内部使用。带有这种特性的 data 字段适合被设置为纯数据字段。<br>好处：纯数据字段有<strong>助于提升页面更新的性能。</strong>  </p>
<h5 id="2-使用规则"><a href="#2-使用规则" class="headerlink" title="2. 使用规则"></a>2. 使用规则</h5><p>在 Component 构造器的 options 节点中，指定 pureDataPattern 为一个正则表达式，字段名符合这个正则<br>表达式的字段将成为纯数据字段，示例代码如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Component</span>(&#123;<br>    <span class="hljs-attr">options</span>:&#123;<br>        <span class="hljs-comment">//指定所有开头的数据字段为纯数据字段</span><br>        <span class="hljs-attr">pureDataPattern</span>:<span class="hljs-regexp">/^_/</span><br>    &#125;，<br>    <span class="hljs-attr">data</span>:&#123;<br>        <span class="hljs-attr">a</span>:<span class="hljs-literal">true</span>,<span class="hljs-comment">//普通数据字段</span><br>        <span class="hljs-attr">_b</span>:<span class="hljs-literal">true</span>,<span class="hljs-comment">//纯数据字段</span><br>     &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<h5 id="3-使用纯数据字段改造数据监听器案例"><a href="#3-使用纯数据字段改造数据监听器案例" class="headerlink" title="3. 使用纯数据字段改造数据监听器案例"></a>3. 使用纯数据字段改造数据监听器案例</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// components/test3/test3.js</span><br><span class="hljs-title class_">Component</span>(&#123;<br>  <span class="hljs-attr">options</span>:&#123;<br>    <span class="hljs-attr">pureDataPattern</span>:<span class="hljs-regexp">/^_/</span><br>  &#125;,<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 组件的初始数据</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-attr">data</span>: &#123;<br>    <span class="hljs-attr">_rgb</span>:&#123;		<span class="hljs-comment">//rgb颜色值对象</span><br>      <span class="hljs-attr">r</span>:<span class="hljs-number">0</span>,<br>      <span class="hljs-attr">g</span>:<span class="hljs-number">0</span>,<br>      <span class="hljs-attr">b</span>:<span class="hljs-number">0</span><br>    &#125;,<br>    <span class="hljs-attr">fullcolor</span>:<span class="hljs-string">&#x27;0,0,0&#x27;</span><span class="hljs-comment">//根据rgb值的三个属性，动态计算fullcolor的值</span><br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="自定义组件-组件的生命周期"><a href="#自定义组件-组件的生命周期" class="headerlink" title="自定义组件 - 组件的生命周期"></a>自定义组件 - 组件的生命周期</h4><h5 id="1-组件全部的生命周期函数"><a href="#1-组件全部的生命周期函数" class="headerlink" title="1.组件全部的生命周期函数"></a>1.组件全部的生命周期函数</h5><p>小程序组件可用的全部生命周期如下表所示：  </p>
<p><img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1650626485619.png" srcset="/img/loading.gif" lazyload></p>
<h5 id="2-组件主要的生命周期函数"><a href="#2-组件主要的生命周期函数" class="headerlink" title="2. 组件主要的生命周期函数"></a>2. 组件主要的生命周期函数</h5><p>在小程序组件中，最重要的生命周期函数有 3 个，分别是 created、attached、detached。它们各自的特点<br>如下：<br>① 组件实例刚被创建好的时候，created 生命周期函数会被触发<br>⚫ 此时还不能调用 setData<br>⚫ 通常在这个生命周期函数中，只应该用于给组件的 this 添加一些自定义的属性字段<br>② 在组件完全初始化完毕、进入页面节点树后， attached 生命周期函数会被触发<br>⚫ 此时， this.data 已被初始化完毕<br>⚫ 这个生命周期很有用，绝大多数初始化的工作可以在这个时机进行（例如发请求获取初始数据）<br>③ 在组件离开页面节点树后， detached 生命周期函数会被触发<br>⚫ 退出一个页面时，会触发页面内每个自定义组件的 detached 生命周期函数<br>⚫ 此时适合做一些清理性质的工作  </p>
<h5 id="3-lifetimes-节点"><a href="#3-lifetimes-节点" class="headerlink" title="3. lifetimes 节点"></a>3. lifetimes 节点</h5><p>在小程序组件中，生命周期函数可以直接定义在 Component 构造器的第一级参数中，可以在 lifetimes 字段<br>内进行声明（这是推荐的方式，其优先级最高）。示例代码如下  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Component</span>(&#123;<br><span class="hljs-comment">//推荐用法</span><br><span class="hljs-attr">lifetimes</span>:&#123;<br><span class="hljs-title function_">attached</span>(<span class="hljs-params"></span>)&#123;&#125;,<span class="hljs-comment">//在组件实例进入页面节点树时执行</span><br><span class="hljs-title function_">detached</span>(<span class="hljs-params"></span>)&#123;&#125;,<span class="hljs-comment">//在组件实例被从页面节点树移除时执行</span><br>&#125;<br><span class="hljs-comment">//以下是旧式的定义方式</span><br><span class="hljs-title function_">attached</span>(<span class="hljs-params"></span>)&#123;&#125;,<span class="hljs-comment">//在组件实例进入页面节点树时执行</span><br><span class="hljs-title function_">detached</span>(<span class="hljs-params"></span>)&#123;&#125;,<span class="hljs-comment">//在组件实例被从页面节点树移除时执行</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<h4 id="自定义组件-组件所在页面的生命周期"><a href="#自定义组件-组件所在页面的生命周期" class="headerlink" title="自定义组件 - 组件所在页面的生命周期"></a>自定义组件 - 组件所在页面的生命周期</h4><h5 id="1-什么是组件所在页面的生命周期"><a href="#1-什么是组件所在页面的生命周期" class="headerlink" title="1.什么是组件所在页面的生命周期"></a>1.什么是组件所在页面的生命周期</h5><p>有时，自定义组件的行为依赖于页面状态的变化，此时就需要用到组件所在页面的生命周期。<br>例如：每当触发页面的 show 生命周期函数的时候，我们希望能够重新生成一个随机的 RGB 颜色值。<br>在自定义组件中，组件所在页面的生命周期函数有如下 3 个，分别是：  </p>
<p><img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1650628222265.png" srcset="/img/loading.gif" lazyload></p>
<h5 id="2-pageLifetimes-节点"><a href="#2-pageLifetimes-节点" class="headerlink" title="2. pageLifetimes 节点"></a>2. pageLifetimes 节点</h5><p>组件所在页面的生命周期函数，需要定义在 pageLifetimes 节点中，示例代码如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Component</span>(&#123;<br><span class="hljs-attr">pageLifetimes</span>:&#123;<br>    <span class="hljs-attr">show</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;,<span class="hljs-comment">//页面被展示</span><br>    <span class="hljs-attr">hide</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;,<span class="hljs-comment">//页面被隐藏</span><br>    <span class="hljs-attr">resize</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">siZe</span>)&#123;&#125;<span class="hljs-comment">//页面尺寸变化</span><br>&#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<h5 id="3-生成随机的-RGB-颜色值"><a href="#3-生成随机的-RGB-颜色值" class="headerlink" title="3.生成随机的 RGB 颜色值"></a>3.生成随机的 RGB 颜色值</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">_randomColor</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>        <span class="hljs-attr">_rgb</span>:&#123;<br>          <span class="hljs-attr">r</span>:<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()*<span class="hljs-number">256</span>),<br>          <span class="hljs-attr">g</span>:<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()*<span class="hljs-number">256</span>),<br>          <span class="hljs-attr">b</span>:<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()*<span class="hljs-number">256</span>)<br>        &#125;<br>      &#125;)<br>    &#125;<br><span class="hljs-attr">pageLifetimes</span>:&#123;<span class="hljs-comment">//所在页面的生命周期函数</span><br>    <span class="hljs-title function_">show</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_randomColor</span>()<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<h4 id="自定义组件-插槽"><a href="#自定义组件-插槽" class="headerlink" title="自定义组件 - 插槽"></a>自定义组件 - 插槽</h4><h4 id="1-什么是插槽"><a href="#1-什么是插槽" class="headerlink" title="1.什么是插槽"></a>1.什么是插槽</h4><p>在自定义组件的 wxml 结构中，可以提供一个 <slot> 节点（插槽），用于承载组件使用者提供的 wxml 结构。  </slot></p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1650629473452.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h5 id="2-单个插槽"><a href="#2-单个插槽" class="headerlink" title="2. 单个插槽"></a>2. 单个插槽</h5><p>在小程序中，默认每个自定义组件中只允许使用一个 <slot> 进行占位，这种个数上的限制叫做单个插槽  </slot></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!--组件的封装者--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;wrapper&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>这里是组件的内部节点<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br><span class="hljs-comment">&lt;!--对于不确定的内容，可以使用&lt;s1ot&gt;进行占位，具体的内容由组件的使用者决定--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br>    <br><span class="hljs-comment">&lt;!--组件的使用者--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">component-tag-name</span>&gt;</span><br><span class="hljs-comment">&lt;!--这部分内容将被放置在组件&lt;s1ot&gt;的位置上--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>这里是插入到组件slot中的内容<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">component-tag-name</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h5 id="3-启用多个插槽"><a href="#3-启用多个插槽" class="headerlink" title="3.启用多个插槽"></a>3.启用多个插槽</h5><p>在小程序的自定义组件中，需要使用多 <slot> 插槽时，可以在组件的 .js 文件中，通过如下方式进行启用。<br>示例代码如下：  </slot></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Component</span>(&#123;<br>  <span class="hljs-attr">options</span>:&#123;<br>	<span class="hljs-attr">multipleSlots</span>:<span class="hljs-literal">true</span><span class="hljs-comment">//在组件定义时的选项中启用多slot支持</span><br>&#125;,<br><span class="hljs-attr">properties</span>:&#123;<span class="hljs-comment">/*...*/</span>&#125;,<br><span class="hljs-attr">methods</span>:&#123;<span class="hljs-comment">/*...*/</span>&#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<h5 id="4-定义多个插槽"><a href="#4-定义多个插槽" class="headerlink" title="4.定义多个插槽"></a>4.定义多个插槽</h5><p>可以在组件的 .wxml 中使用多个 <slot> 标签，以不同的 name 来区分不同的插槽。示例代码如下：  </slot></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!--组件模板-&gt;</span><br><span class="hljs-comment">&lt;view class=&quot;wrapper&quot;&gt;</span><br><span class="hljs-comment">&lt;!--name为before的第一个slot插槽--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;before&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>这是一段固定的文本内容<span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span><br><span class="hljs-comment">&lt;!--name为after的第二个slot插槽--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;after&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h5 id="5-使用多个插槽"><a href="#5-使用多个插槽" class="headerlink" title="5. 使用多个插槽"></a>5. 使用多个插槽</h5><p>在使用带有多个插槽的自定义组件时，需要用 slot 属性来将节点插入到不同的 <slot> 中。示例代码如下：  </slot></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!--引用组件的页面模板--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">component-tag-name</span>&gt;</span><br><span class="hljs-comment">&lt;!--这部分内容将被放置在组件&lt;slot name=&quot;before&quot;&gt;的位置上--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">&quot;before&quot;</span>&gt;</span>这里是插入到组件slot name=&quot;before&quot;中的内容<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br><span class="hljs-comment">&lt;!--这部分内容将被放置在组件&lt;slot name=&quot;after&quot;&gt;的位置上--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">&quot;after&quot;</span>&gt;</span>这里是插入到组件slot name=&quot;after&quot;中的内容<span class="hljs-tag">&lt;<span class="hljs-name">view</span></span><br><span class="hljs-tag">&lt;/<span class="hljs-attr">component-tag-name</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="自定义组件-父子组件之间的通信"><a href="#自定义组件-父子组件之间的通信" class="headerlink" title="自定义组件 - 父子组件之间的通信"></a>自定义组件 - 父子组件之间的通信</h4><h5 id="1-父子组件之间通信的-3-种方式"><a href="#1-父子组件之间通信的-3-种方式" class="headerlink" title="1. 父子组件之间通信的 3 种方式"></a>1. 父子组件之间通信的 3 种方式</h5><p>① 属性绑定<br>⚫ 用于父组件向子组件的指定属性设置数据，仅能设置 JSON 兼容的数据<br>② 事件绑定<br>⚫ 用于子组件向父组件传递数据，可以传递任意数据<br>③ 获取组件实例<br>⚫ 父组件还可以通过 this.selectComponent() 获取子组件实例对象<br>⚫ 这样就可以直接访问子组件的任意数据和方法  </p>
<h5 id="2-属性绑定"><a href="#2-属性绑定" class="headerlink" title="2. 属性绑定"></a>2. 属性绑定</h5><p>属性绑定用于实现父向子传值，而且只能传递普通类型的数据，无法将方法传递给子组件。父组件的示例代码<br>如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//父组件的data节点</span><br><span class="hljs-attr">data</span>:&#123;<br><span class="hljs-attr">count</span>:<span class="hljs-number">0</span><br>&#125;<br><span class="hljs-comment">//父组件的Wxml结构</span><br>&lt;my-test5 count=<span class="hljs-string">&quot;&#123;&#123;count&#125;&#125;&quot;</span>&gt;&lt;/my-test5&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>~~~~<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>父组件中，count值为：&#123;&#123;count&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>子组件在 properties 节点中声明对应的属性并使用。示例代码如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//子组件的properties节点</span><br><span class="hljs-attr">properties</span>:&#123;<br><span class="hljs-attr">count</span>:<span class="hljs-title class_">Number</span><br>&#125;,<br><span class="hljs-comment">//子组件的wxml结构</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">text</span>&gt;</span>子组件中，count值为：&#123;&#123;count&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<h5 id="3-事件绑定"><a href="#3-事件绑定" class="headerlink" title="3. 事件绑定"></a>3. 事件绑定</h5><p>事件绑定用于实现子向父传值，可以传递任何类型的数据。使用步骤如下：<br>① 在父组件的 js 中，定义一个函数，这个函数即将通过自定义事件的形式，传递给子组件<br>② 在父组件的 wxml 中，通过自定义事件的形式，将步骤 1 中定义的函数引用，传递给子组件<br>③ 在子组件的 js 中，通过调用 this.triggerEvent(‘自定义事件名称’, { &#x2F;* 参数对象 *&#x2F; }) ，将数据发送到父组件<br>④ 在父组件的 js 中，通过 e.detail 获取到子组件传递过来的数据  </p>
<p>步骤1：在父组件的 js 中，定义一个函数，这个函数即将通过自定义事件的形式，传递给子组件。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//在父组件中定义syncCount方法</span><br><span class="hljs-comment">//将来，这个方法会被传递给子组件，供子组件进行调用</span><br><span class="hljs-title function_">syncCount</span>(<span class="hljs-params">e</span>)&#123;<br>    <span class="hljs-comment">// console.log(&#x27;syncCount&#x27;)</span><br>    <span class="hljs-comment">// console.log(e.detail.value)</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>      <span class="hljs-attr">count</span>:e.<span class="hljs-property">detail</span>.<span class="hljs-property">value</span><br>    &#125;)<br>  &#125;,<br></code></pre></td></tr></table></figure>

<p>步骤2：在父组件的 wxml 中，通过自定义事件的形式，将步骤 1 中定义的函数引用，传递给子组件。  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!--使用bind:自定义事件名称（推荐：结构清晰--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">my-test3</span> <span class="hljs-attr">count</span>=<span class="hljs-string">&quot;&#123;&#123;count&#125;&#125;&quot;</span><span class="hljs-attr">bind:sync</span>=<span class="hljs-string">&quot;syncCount&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">my-test3</span>&gt;</span><br><span class="hljs-comment">&lt;!--或在bind后面直接写上自定义事件名称--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">my-test3</span> <span class="hljs-attr">count</span>=<span class="hljs-string">&quot;&#123;&#123;count&#125;&#125;&quot;</span><span class="hljs-attr">bindsync</span>=<span class="hljs-string">&quot;syncCount&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">my-test3</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>步骤3：在子组件的 js 中，通过调用 this.triggerEvent(‘自定义事件名称’, { &#x2F;* 参数对象 *&#x2F; }) ，将数据发送到父组件。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//子组件的wxml结构</span><br>&lt;text&gt;子组件中，count值为：&#123;&#123;count&#125;&#125;&lt;/text&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;addCount&quot;</span>&gt;</span>count+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="hljs-comment">//子组件的js代码</span><br> <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-title function_">addCount</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>        <span class="hljs-attr">count</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">count</span>+<span class="hljs-number">1</span><br>      &#125;)<br>      <span class="hljs-comment">//触发自定义事件，将数值同步给组件</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">&#x27;sync&#x27;</span>,&#123;<span class="hljs-attr">value</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">properties</span>.<span class="hljs-property">count</span>&#125;)<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>步骤4：在父组件的 js 中，通过 e.detail 获取到子组件传递过来的数据。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">syncCount</span>(<span class="hljs-params">e</span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123;<br>      <span class="hljs-attr">count</span>:e.<span class="hljs-property">detail</span>.<span class="hljs-property">value</span><br>    &#125;)<br>  &#125;,<br></code></pre></td></tr></table></figure>

<h5 id="4-获取组件实例-没太懂2022-4-23"><a href="#4-获取组件实例-没太懂2022-4-23" class="headerlink" title="4. 获取组件实例(没太懂2022.4.23)"></a>4. 获取组件实例(没太懂2022.4.23)</h5><p>可在父组件里调用 this.selectComponent(“id或class选择器”) ，获取子组件的实例对象，从而直接访问子组<br>件的任意数据和方法。调用时需要传入一个选择器，例如 this.selectComponent(“.my-component”)。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//Xml结构</span><br>&lt;my-test3 count=<span class="hljs-string">&quot;&#123;&#123;count&#125;&#125;&quot;</span><span class="hljs-attr">bind</span>:sync=<span class="hljs-string">&quot;syncCount&quot;</span><span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;customA&quot;</span>id=<span class="hljs-string">&quot;CA&quot;</span>&gt;<br>&lt;/my-test3&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;getChild&quot;</span>&gt;</span>获取子组件实例<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><br><span class="hljs-comment">//js</span><br><span class="hljs-title function_">getChild</span>(<span class="hljs-params"></span>)&#123;<span class="hljs-comment">//按钮的tap事件处理函数</span><br>/切记下面参数不能传递标签选择器<span class="hljs-string">&#x27;my-test3&#x27;</span>,不然返回的是nul1<br>    <span class="hljs-keyword">const</span> child=<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">selectComponent</span>(<span class="hljs-string">&#x27;.customA&#x27;</span>)<span class="hljs-comment">//也可以传递id选择器#cA</span><br>    child.<span class="hljs-title function_">setData</span>(&#123;<span class="hljs-attr">count</span>:child.<span class="hljs-property">properties</span>.<span class="hljs-property">count</span>+<span class="hljs-number">1</span>&#125;)<span class="hljs-comment">//调用子组件的setData方法</span><br>    child.<span class="hljs-title function_">addCount</span>()<span class="hljs-comment">//调用子组件的addCount方法</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="自定义组件-behaviors"><a href="#自定义组件-behaviors" class="headerlink" title="自定义组件 - behaviors"></a>自定义组件 - behaviors</h4><h5 id="1-什么是-behaviors"><a href="#1-什么是-behaviors" class="headerlink" title="1.什么是 behaviors"></a>1.什么是 behaviors</h5><p>behaviors 是小程序中，用于实现组件间代码共享的特性，类似于 Vue.js 中的 “mixins”。  </p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1650675866671.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h5 id="2-behaviors-的工作方式"><a href="#2-behaviors-的工作方式" class="headerlink" title="2.behaviors 的工作方式"></a>2.behaviors 的工作方式</h5><p>每个 behavior 可以包含一组属性、数据、生命周期函数和方法。组件引用它时，它的属性、数据和方法会被<br>合并到组件中。<br>每个组件可以引用多个 behavior，behavior 也可以引用其它 behavior。</p>
<h5 id="3-创建-behavior"><a href="#3-创建-behavior" class="headerlink" title="3.创建 behavior"></a>3.创建 behavior</h5><p>调用 Behavior(Object object) 方法即可创建一个共享的 behavior 实例对象，供所有的组件使用：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//调用Behavior()方法，创建实例对象</span><br><span class="hljs-comment">//并使用module.exports将behavior实例对象共享出去</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">Behavior</span>(&#123;<br>  <span class="hljs-attr">data</span>:&#123;<br>    <span class="hljs-attr">uesrname</span>:<span class="hljs-string">&#x27;zs&#x27;</span><br>  &#125;,<br>  <span class="hljs-attr">properties</span>:&#123;&#125;,<br>  <span class="hljs-attr">methods</span>:&#123;&#125;<br>  &#125;)<br></code></pre></td></tr></table></figure>

<h4 id="4-导入并使用-behavior"><a href="#4-导入并使用-behavior" class="headerlink" title="4. 导入并使用 behavior"></a>4. 导入并使用 behavior</h4><p>在组件中，使用 require() 方法导入需要的 behavior，挂载后即可访问 behavior 中的数据或方法，示例代码<br>如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// components/test5/test5.js</span><br><span class="hljs-comment">//使用 require() 方法导入需要的 behavior</span><br><span class="hljs-keyword">const</span> myBehavior=<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../../behaviors/my-behavior&#x27;</span>)<br><span class="hljs-title class_">Component</span>(&#123;<br>    <span class="hljs-comment">//将实例挂载到behavior 中的数组结点</span><br>  <span class="hljs-attr">behaviors</span>:[myBehavior],<br>&#125;)<br></code></pre></td></tr></table></figure>

<h5 id="5-behavior-中所有可用的节点"><a href="#5-behavior-中所有可用的节点" class="headerlink" title="5. behavior 中所有可用的节点"></a>5. behavior 中所有可用的节点</h5><img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1650677157797.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h5 id="6-同名字段的覆盖和组合规则"><a href="#6-同名字段的覆盖和组合规则" class="headerlink" title="6. 同名字段的覆盖和组合规则*"></a>6. 同名字段的覆盖和组合规则*</h5><p>组件和它引用的 behavior 中可以包含同名的字段，此时可以参考如下 3 种同名时的处理规则：<br>① 同名的数据字段 (data)<br>② 同名的属性 (properties) 或方法 (methods)<br>③ 同名的生命周期函数<br>关于详细的覆盖和组合规则，大家可以参考微信小程序官方文档给出的说明：<br><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/behaviors.html">https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/behaviors.html</a>  </p>
<h3 id="使用-npm-包"><a href="#使用-npm-包" class="headerlink" title="使用 npm 包"></a>使用 npm 包</h3><h4 id="使用-npm-包—Vant-Weapp"><a href="#使用-npm-包—Vant-Weapp" class="headerlink" title="使用 npm 包—Vant Weapp"></a>使用 npm 包—Vant Weapp</h4><h5 id="小程序对-npm-的支持与限制"><a href="#小程序对-npm-的支持与限制" class="headerlink" title="小程序对 npm 的支持与限制"></a>小程序对 npm 的支持与限制</h5><p>目前，小程序中已经支持使用 npm 安装第三方包，从而来提高小程序的开发效率。但是，在小程序中使用<br>npm 包有如下 3 个限制：<br>① 不支持依赖于 Node.js 内置库的包<br>② 不支持依赖于浏览器内置对象的包<br>③ 不支持依赖于 C++ 插件的包<br>总结：虽然 npm 上的包有千千万，但是能供小程序使用的包却“为数不多”。  </p>
<h5 id="什么是-Vant-Weapp"><a href="#什么是-Vant-Weapp" class="headerlink" title="什么是 Vant Weapp"></a>什么是 Vant Weapp</h5><p>Vant Weapp 是有赞前端团队开源的一套小程序 UI 组件库，助力开发者快速搭建小程序应用。它所使用的是<br>MIT 开源许可协议，对商业使用比较友好。<br>官方文档地址 <a target="_blank" rel="noopener" href="https://youzan.github.io/vant-weapp">https://youzan.github.io/vant-weapp</a>  </p>
<h5 id="2-安装-Vant-组件库"><a href="#2-安装-Vant-组件库" class="headerlink" title="2. 安装 Vant 组件库"></a>2. 安装 Vant 组件库</h5><p>在小程序项目中，安装 Vant 组件库主要分为如下 3 步：<br>① 通过 npm 安装（建议指定版本为@1.3.3）<br>② 构建 npm 包<br>③ 修改 app.json<br>详细的操作步骤，大家可以参考 Vant 官方提供的快速上手教程：<br><a target="_blank" rel="noopener" href="https://youzan.github.io/vant-weapp/#/quickstart#an-zhuang">https://youzan.github.io/vant-weapp/#/quickstart#an-zhuang</a>  </p>
<h5 id="3-使用-Vant-组件"><a href="#3-使用-Vant-组件" class="headerlink" title="3. 使用 Vant 组件"></a>3. 使用 Vant 组件</h5><p>安装完 Vant 组件库之后，可以在 app.json 的 usingComponents 节点中引入需要的组件，即可在 wxml 中<br>直接使用组件。示例代码如下：  </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;usingComponents&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;van-button&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;path/to/vant-weapp/dist/button/index&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h5 id="4-定制全局主题样式"><a href="#4-定制全局主题样式" class="headerlink" title="4. 定制全局主题样式"></a>4. 定制全局主题样式</h5><p>Vant Weapp 使用 CSS 变量来实现定制主题。 关于 CSS 变量的基本用法，请参考 MDN 文档：<br><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Using_CSS_custom_properties">https://developer.mozilla.org/zh-CN/docs/Web/CSS/Using_CSS_custom_properties</a>  </p>
<h5 id="5-定制全局主题样式"><a href="#5-定制全局主题样式" class="headerlink" title="5.定制全局主题样式"></a>5.定制全局主题样式</h5><p>在 app.wxss 中，写入 CSS 变量，即可对全局生效：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/**app.wxss**/</span><br> page&#123;<span class="hljs-comment">/*page是根结点*/</span><br>     <span class="hljs-comment">/*自定义告警结点的样式*/</span><br>  <span class="hljs-attr">--button-danger-background-color</span>:<span class="hljs-number">#C00000</span>;<br>  <span class="hljs-attr">--button-danger-border-color</span>:<span class="hljs-number">#D60000</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>所有可用的颜色变量，请参考 Vant 官方提供的配置文件：<br><a target="_blank" rel="noopener" href="https://github.com/youzan/vant-weapp/blob/dev/packages/common/style/var.less">https://github.com/youzan/vant-weapp/blob/dev/packages/common/style/var.less</a>  </p>
<h4 id="使用-npm-包-API-Promise化"><a href="#使用-npm-包-API-Promise化" class="headerlink" title="使用 npm 包 - API Promise化"></a>使用 npm 包 - API Promise化</h4><h5 id="1-基于回调函数的异步-API-的缺点"><a href="#1-基于回调函数的异步-API-的缺点" class="headerlink" title="1.基于回调函数的异步 API 的缺点"></a>1.基于回调函数的异步 API 的缺点</h5><p>默认情况下，小程序官方提供的异步 API 都是基于回调函数实现的，例如，网络请求的 API 需要按照如下的方<br>式调用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">wx.<span class="hljs-title function_">request</span>(&#123;<br><span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;&#x27;</span>,<br><span class="hljs-attr">url</span>:<span class="hljs-string">&#x27;&#x27;</span>,<br><span class="hljs-attr">data</span>:&#123;&#125;,<br><span class="hljs-attr">success</span>:<span class="hljs-function">()=&gt;</span>&#123;&#125;,<span class="hljs-comment">//请求成功的回调函数</span><br><span class="hljs-attr">fail</span>:<span class="hljs-function">()=&gt;</span>&#123;&#125;,<span class="hljs-comment">//请求失败的回调函数</span><br><span class="hljs-attr">complete</span>:<span class="hljs-function">()=&gt;</span>&#123;&#125;<span class="hljs-comment">//请求完成的回调函数</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<p>缺点：容易造成回调地狱的问题，代码的可读性、维护性差！  </p>
<h5 id="2-什么是-API-Promise-化"><a href="#2-什么是-API-Promise-化" class="headerlink" title="2. 什么是 API Promise 化"></a>2. 什么是 API Promise 化</h5><p>API Promise化，指的是通过额外的配置，将官方提供的、基于回调函数的异步 API，升级改造为基于<br>Promise 的异步 API，从而提高代码的可读性、维护性，避免回调地狱的问题。  </p>
<h5 id="3-实现-API-Promise-化"><a href="#3-实现-API-Promise-化" class="headerlink" title="3. 实现 API Promise 化"></a>3. 实现 API Promise 化</h5><p>在小程序中，实现 API Promise 化主要依赖于 miniprogram-api-promise 这个第三方的 npm 包。它的安装<br>和使用步骤如下：  </p>
<p>命令行安装命令：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">npm install --save miniprogram-api-promise@<span class="hljs-number">1.0</span><span class="hljs-number">.4</span><br></code></pre></td></tr></table></figure>

<p>使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//在小程序入口文件中(app.js),只需调用一次promisifyAll()方法，</span><br><span class="hljs-comment">//即可实现异步API的Promise化</span><br><span class="hljs-keyword">import</span> &#123;promisifyAll&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;miniprogram-api-promise&#x27;</span><br><span class="hljs-keyword">const</span> wxp wx.<span class="hljs-property">p</span> =&#123;&#125;<br><span class="hljs-comment">//promisify all wx&#x27;s api</span><br><span class="hljs-title function_">promisifyAll</span>(wx,wxp)<br></code></pre></td></tr></table></figure>

<h5 id="4-调用-Promise-化之后的异步-API"><a href="#4-调用-Promise-化之后的异步-API" class="headerlink" title="4. 调用 Promise 化之后的异步 API"></a>4. 调用 Promise 化之后的异步 API</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">getInfo</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">const</span> res= wx.<span class="hljs-property">p</span>.<span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;get&#x27;</span>,<br>    <span class="hljs-attr">url</span>:<span class="hljs-string">&#x27;https://www.escook.cn/api/get&#x27;</span>,<br>    <span class="hljs-attr">data</span>:&#123;<br>      <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;zs&#x27;</span>,<br>      <span class="hljs-attr">age</span>:<span class="hljs-number">20</span><br>    &#125;<br>  &#125;)<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)<br>&#125;,<br></code></pre></td></tr></table></figure>

<h3 id="全局数据共享"><a href="#全局数据共享" class="headerlink" title="全局数据共享"></a>全局数据共享</h3><h4 id="1-什么是全局数据共享"><a href="#1-什么是全局数据共享" class="headerlink" title="1. 什么是全局数据共享"></a>1. 什么是全局数据共享</h4><p>全局数据共享（又叫做：状态管理）是为了解决组件之间数据共享的问题。<br>开发中常用的全局数据共享方案有：Vuex、Redux、MobX 等。  </p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1650682083381.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h4 id="2-小程序中的全局数据共享方案"><a href="#2-小程序中的全局数据共享方案" class="headerlink" title="2. 小程序中的全局数据共享方案"></a>2. 小程序中的全局数据共享方案</h4><p>在小程序中，可使用 mobx-miniprogram 配合 mobx-miniprogram-bindings 实现全局数据共享。其中：<br> mobx-miniprogram 用来创建 Store 实例对象<br> mobx-miniprogram-bindings 用来把 Store 中的共享数据或方法，绑定到组件或页面中使用  </p>
<h4 id="全局数据共享-MobX"><a href="#全局数据共享-MobX" class="headerlink" title="全局数据共享 - MobX"></a>全局数据共享 - MobX</h4><h5 id="1-安装-MobX-相关的包"><a href="#1-安装-MobX-相关的包" class="headerlink" title="1. 安装 MobX 相关的包"></a>1. 安装 MobX 相关的包</h5><p>在项目中运行如下的命令，安装 MobX 相关的包：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">npm</span> install --save mobx-miniprogram@<span class="hljs-number">4</span>.<span class="hljs-number">13</span>.<span class="hljs-number">2</span> mobx-miniprogram-bindings@<span class="hljs-number">1</span>.<span class="hljs-number">2</span>.<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>注意：MobX 相关的包安装完毕之后，记得重新构建 npm。  </p>
<h5 id="2-创建-MobX-的-Store-实例"><a href="#2-创建-MobX-的-Store-实例" class="headerlink" title="2. 创建 MobX 的 Store 实例"></a>2. 创建 MobX 的 Store 实例</h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ct5211314/article/details/120322080?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165068256216780357299904%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165068256216780357299904&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-120322080.142%5Ev9%5Econtrol,157%5Ev4%5Econtrol&utm_term=%E5%B0%8F%E7%A8%8B%E5%BA%8FMobX&spm=1018.2226.3001.4187">参考：微信小程序中的vuex（MobX）</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//在这个js，文件中，专门创建store实例对象</span><br><span class="hljs-keyword">import</span> &#123;observable,action&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx-miniprogram&#x27;</span><span class="hljs-comment">//这里导出observable和action方法，后面才能使用</span><br><span class="hljs-comment">//observable创建仓库</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">observable</span>(&#123;<br>  <span class="hljs-comment">// 数据字段</span><br>  <span class="hljs-attr">numA</span>: <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">numB</span>: <span class="hljs-number">2</span>,<br><br>  <span class="hljs-comment">// 计算属性 数据改变时会执行，vue中的计算属性，返回sum这个变量</span><br><br>  <span class="hljs-keyword">get</span> <span class="hljs-title function_">sum</span>() &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">numA</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">numB</span><br>  &#125;,<br><br>  <span class="hljs-comment">//actions 方法用于改变仓库的值</span><br>  <span class="hljs-attr">updateNum1</span>: <span class="hljs-title function_">action</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">step</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">numA</span> += step   <br>  &#125;),<br>  <span class="hljs-attr">updateNum2</span>: <span class="hljs-title function_">action</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">step</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">numB</span> += step<br>  &#125;)<br>&#125;);<br></code></pre></td></tr></table></figure>

<h5 id="3-将-Store-中的成员绑定到页面中"><a href="#3-将-Store-中的成员绑定到页面中" class="headerlink" title="3. 将 Store 中的成员绑定到页面中"></a>3. 将 Store 中的成员绑定到页面中</h5><p>页面的JS文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createStoreBindings &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx-miniprogram-bindings&quot;</span>;<span class="hljs-comment">//导入createStoreBindings的方法，可以将数据绑定至页面</span><br><span class="hljs-keyword">import</span> &#123; store &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../store/store&quot;</span>;<span class="hljs-comment">//导入store实例</span><br><span class="hljs-title class_">Page</span>(&#123;<br>  <span class="hljs-attr">data</span>: &#123;<br>    <span class="hljs-attr">someData</span>: <span class="hljs-string">&quot;...&quot;</span>,<br>  &#125;,<br>  <span class="hljs-title function_">onLoad</span>() <span class="hljs-keyword">function</span> (<span class="hljs-params">options</span>)&#123;<span class="hljs-comment">//生命周期函数--监听页面加载</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">storeBindings</span> = <span class="hljs-title function_">createStoreBindings</span>(<span class="hljs-variable language_">this</span>, &#123;<br>      store,<span class="hljs-comment">//数据源</span><br>      <span class="hljs-attr">fields</span>: [<span class="hljs-string">&quot;numA&quot;</span>, <span class="hljs-string">&quot;numB&quot;</span>, <span class="hljs-string">&quot;sum&quot;</span>],<span class="hljs-comment">//公共变量</span><br>      <span class="hljs-attr">actions</span>: [<span class="hljs-string">&quot;update&quot;</span>],<span class="hljs-comment">//公共方法</span><br>    &#125;)<br>  &#125;,<br>  <span class="hljs-title function_">onUnload</span>() <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<span class="hljs-comment">//生命周期函数--监听页面卸载</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">storeBindings</span>.<span class="hljs-title function_">destroyStoreBindings</span>();<span class="hljs-comment">//数据清理</span><br>  &#125;,<br>  <span class="hljs-title function_">myMethod</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">sum</span>; <span class="hljs-comment">// 来自于 MobX store 的字段</span><br>  &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure>

<h5 id="4-在页面使用store的成员"><a href="#4-在页面使用store的成员" class="headerlink" title="4.在页面使用store的成员"></a>4.在页面使用store的成员</h5><p>页面结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!--pages/message/message.wxml--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">text</span>&gt;</span>pages/message/message.wxml<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">van-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;btnHandler1&quot;</span> <span class="hljs-attr">data-step</span>=<span class="hljs-string">&quot;&#123;&#123;1&#125;&#125;&quot;</span>&gt;</span><span class="hljs-comment">&lt;!--加一按钮--&gt;</span><br>    numA + 1<br><span class="hljs-tag">&lt;/<span class="hljs-name">van-button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">van-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;danger&quot;</span>  <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;btnHandler1&quot;</span> <span class="hljs-attr">data-step</span>=<span class="hljs-string">&quot;&#123;&#123;-1&#125;&#125;&quot;</span>&gt;</span><span class="hljs-comment">&lt;!--减一按钮--&gt;</span><br>    numA -1<br><span class="hljs-tag">&lt;/<span class="hljs-name">van-button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>&#123;&#123;numA&#125;&#125;+&#123;&#123;numB&#125;&#125;=&#123;&#123;sum&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>js函数方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//加一减一按钮的事件处理函数</span><br>  <span class="hljs-title function_">btnHandler1</span>(<span class="hljs-params">e</span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateNum1</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">dataset</span>.<span class="hljs-property">step</span>)<br>  &#125;,<br></code></pre></td></tr></table></figure>

<h5 id="5-将-Store-中的成员绑定到组件中"><a href="#5-将-Store-中的成员绑定到组件中" class="headerlink" title="5.将 Store 中的成员绑定到组件中"></a>5.将 Store 中的成员绑定到组件中</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// components/numbes/numnes.js</span><br><span class="hljs-keyword">import</span> &#123;storeBindingsBehavior&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mobx-miniprogram-bindings&#x27;</span><span class="hljs-comment">//导入mobx-miniprogram-bindings包的storeBindingsBehavior</span><br><span class="hljs-keyword">import</span> &#123;store&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../store/store&#x27;</span><span class="hljs-comment">//导入stord实例</span><br><span class="hljs-title class_">Component</span>(&#123;<br>  <span class="hljs-attr">behaviors</span>:[storeBindingsBehavior],<span class="hljs-comment">//通过storeBindingsBehavior实现自动绑定</span><br>  <span class="hljs-attr">storeBindings</span>:&#123;<br>    <span class="hljs-comment">//指定要绑定的Store</span><br>    store,<br>    <span class="hljs-attr">fields</span>:&#123;<span class="hljs-comment">//指定要绑定的字段数据</span><br>      <span class="hljs-attr">numA</span>:<span class="hljs-string">&#x27;numA&#x27;</span>,<span class="hljs-comment">//前者是组件中自定义的数据名后者是对应store中的数据,前者可以自定义</span><br>      <span class="hljs-attr">numB</span>:<span class="hljs-string">&#x27;numB&#x27;</span>,<br>      <span class="hljs-attr">sum</span>:<span class="hljs-string">&#x27;sum&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">actions</span>: [<span class="hljs-string">&quot;updateNum2&quot;</span>],<span class="hljs-comment">//公共方法updateNum2</span><br>  &#125;,<br>&#125;)<br></code></pre></td></tr></table></figure>

<h5 id="6-在组件中使用-Store-中的成员"><a href="#6-在组件中使用-Store-中的成员" class="headerlink" title="6. 在组件中使用 Store 中的成员"></a>6. 在组件中使用 Store 中的成员</h5><p>结构:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">van-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;btnHandler2&quot;</span> <span class="hljs-attr">data-step</span>=<span class="hljs-string">&quot;&#123;&#123;1&#125;&#125;&quot;</span>&gt;</span>numB + 1<span class="hljs-tag">&lt;/<span class="hljs-name">van-button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">van-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;danger&quot;</span>  <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;btnHandler2&quot;</span> <span class="hljs-attr">data-step</span>=<span class="hljs-string">&quot;&#123;&#123;-1&#125;&#125;&quot;</span>&gt;</span>numB -1<span class="hljs-tag">&lt;/<span class="hljs-name">van-button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>&#123;&#123;numA&#125;&#125;+&#123;&#123;numB&#125;&#125;=&#123;&#123;sum&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>处理函数:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">methods</span>: &#123;<br>   <span class="hljs-title function_">btnHandler2</span>(<span class="hljs-params">e</span>)&#123;<br>     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e)<br>     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateNum2</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">dataset</span>.<span class="hljs-property">step</span>)<br>   &#125;   <br>   &#125;<br></code></pre></td></tr></table></figure>

<h3 id="分包"><a href="#分包" class="headerlink" title="分包"></a>分包</h3><h4 id="分包-基础概念"><a href="#分包-基础概念" class="headerlink" title="分包-基础概念"></a>分包-基础概念</h4><h5 id="1-什么是分包"><a href="#1-什么是分包" class="headerlink" title="1.什么是分包"></a>1.什么是分包</h5><p>分包指的是把一个完整的小程序项目，按照需求划分为不同的子包，在构建时打包成不同的分包，用户在使用时按需进行加载。 </p>
<h5 id="2-分包的好处"><a href="#2-分包的好处" class="headerlink" title="2. 分包的好处"></a>2. 分包的好处</h5><p>对小程序进行分包的好处主要有以下两点：<br> 可以优化小程序首次启动的下载时间<br>在多团队共同开发时可以更好的解耦协作   </p>
<h5 id="3-分包前项目的构成"><a href="#3-分包前项目的构成" class="headerlink" title="3.分包前项目的构成"></a>3.分包前项目的构成</h5><p>分包前，小程序项目中所有的页面和资源都被打包到了一起，导致整个项目体积过大，影响小程序首次启动的下载时间。  </p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1651288715815.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h5 id="4-分包后项目的构成"><a href="#4-分包后项目的构成" class="headerlink" title="4.分包后项目的构成"></a>4.分包后项目的构成</h5><p>分包后，小程序项目由 1 个主包 + 多个分包组成：<br> 主包：一般只包含项目的启动页面或 TabBar 页面、以及所有分包都需要用到的一些公共资源<br> 分包：只包含和当前分包有关的页面和私有资源  </p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1651288805650.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h5 id="5-分包的加载规则"><a href="#5-分包的加载规则" class="headerlink" title="5. 分包的加载规则"></a>5. 分包的加载规则</h5><p>① 在小程序启动时，默认会下载主包并启动主包内页面<br> tabBar 页面需要放到主包中<br>② 当用户进入分包内某个页面时，客户端会把对应分包下载下来，下载完成后再进行展示<br> 非 tabBar 页面可以按照功能的不同，划分为不同的分包之后，进行按需下载  </p>
<h5 id="6-分包的体积限制"><a href="#6-分包的体积限制" class="headerlink" title="6. 分包的体积限制"></a>6. 分包的体积限制</h5><p>目前，小程序分包的大小有以下两个限制：<br> 整个小程序所有分包大小不超过 16M（主包 + 所有分包）<br> 单个分包&#x2F;主包大小不能超过 2M  </p>
<h4 id="分包-使用分包"><a href="#分包-使用分包" class="headerlink" title="分包 - 使用分包"></a>分包 - 使用分包</h4><h5 id="1-配置方法"><a href="#1-配置方法" class="headerlink" title="1.配置方法"></a>1.配置方法</h5><img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1651289216956.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h5 id="2-打包原则"><a href="#2-打包原则" class="headerlink" title="2.打包原则"></a>2.打包原则</h5><p>① 小程序会按 subpackages 的配置进行分包，subpackages 之外的目录将被打包到主包中<br>② 主包也可以有自己的 pages（即最外层的 pages 字段）<br>③ tabBar 页面必须在主包内<br>④ 分包之间不能互相嵌套  </p>
<h5 id="3-引用原则"><a href="#3-引用原则" class="headerlink" title="3.引用原则"></a>3.引用原则</h5><p>① 主包无法引用分包内的私有资源<br>② 分包之间不能相互引用私有资源<br>③ 分包可以引用主包内的公共资源  </p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1651289751946.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h4 id="分包-独立分包"><a href="#分包-独立分包" class="headerlink" title="分包-独立分包"></a>分包-独立分包</h4><h5 id="1-什么是独立分包"><a href="#1-什么是独立分包" class="headerlink" title="1. 什么是独立分包"></a>1. 什么是独立分包</h5><p>独立分包本质上也是分包，只不过它比较特殊，可以独立于主包和其他分包而单独运行。  </p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1651289989478.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h5 id="2-独立分包和普通分包的区别"><a href="#2-独立分包和普通分包的区别" class="headerlink" title="2. 独立分包和普通分包的区别"></a>2. 独立分包和普通分包的区别</h5><p>最主要的区别：是否依赖于主包才能运行<br> 普通分包必须依赖于主包才能运行<br> 独立分包可以在不下载主包的情况下，独立运行  </p>
<h5 id="3-独立分包的应用场景"><a href="#3-独立分包的应用场景" class="headerlink" title="3. 独立分包的应用场景"></a>3. 独立分包的应用场景</h5><p>开发者可以按需，将某些具有一定功能独立性的页面配置到独立分包中。原因如下：<br>当小程序从普通的分包页面启动时，需要首先下载主包<br>而独立分包不依赖主包即可运行，可以很大程度上提升分包页面的启动速度<br>注意：一个小程序中可以有多个独立分包。  </p>
<h5 id="4-独立分包的配置方法"><a href="#4-独立分包的配置方法" class="headerlink" title="4. 独立分包的配置方法"></a>4. 独立分包的配置方法</h5><p>在分包配置里加入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&quot;independent&quot;</span>: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1651290400594.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h5 id="5-引用原则"><a href="#5-引用原则" class="headerlink" title="5. 引用原则"></a>5. 引用原则</h5><p>独立分包和普通分包以及主包之间，是相互隔绝的，不能相互引用彼此的资源！例如：<br>① 主包无法引用独立分包内的私有资源<br>② 独立分包之间，不能相互引用私有资源<br>③ 独立分包和普通分包之间，不能相互引用私有资源<br>④ <strong>特别注意：</strong>独立分包中不能引用主包内的公共资源  </p>
<h4 id="分包-分包预下载"><a href="#分包-分包预下载" class="headerlink" title="分包 - 分包预下载"></a>分包 - 分包预下载</h4><h5 id="1-什么是分包预下载"><a href="#1-什么是分包预下载" class="headerlink" title="1. 什么是分包预下载"></a>1. 什么是分包预下载</h5><p>分包预下载指的是：在进入小程序的某个页面时，由框架自动预下载可能需要的分包，从而提升进入后续分包<br>页面时的启动速度。  </p>
<h5 id="2-配置分包的预下载"><a href="#2-配置分包的预下载" class="headerlink" title="2. 配置分包的预下载"></a>2. 配置分包的预下载</h5><p>预下载分包的行为，会在进入指定的页面时触发。在 app.json 中，使用 preloadRule 节点定义分包的预下载<br>规则，示例代码如下：  </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;preloadRule&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-comment">//分包预下载的规则</span><br>    <span class="hljs-attr">&quot;pages/contact/contact&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-comment">//触发分包预下载的页面路径</span><br>        <span class="hljs-comment">//packages表示进入页面后，预下载哪些分包</span><br>        <span class="hljs-attr">&quot;packages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;pagA&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;network&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;all&quot;</span><br>        <span class="hljs-comment">//network表示在指定的网络模式下进行预下载，</span><br>        <span class="hljs-comment">//可选值为：al1(不限网络)和wifi(仅wifi模式下进行预下载)</span><br>    <span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h5 id="3-分包预下载的限制"><a href="#3-分包预下载的限制" class="headerlink" title="3. 分包预下载的限制"></a>3. 分包预下载的限制</h5><p>同一个分包中的页面享有共同的预下载大小限额 2M，例如：  </p>
<img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1651291569392.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h3 id="案例-自定义-tabBar"><a href="#案例-自定义-tabBar" class="headerlink" title="案例 - 自定义 tabBar"></a>案例 - 自定义 tabBar</h3><h4 id="1-案例效果"><a href="#1-案例效果" class="headerlink" title="1.案例效果"></a>1.案例效果</h4><img src="https://image-1308319148.cos.ap-chengdu.myqcloud.com/main/1651291693861.png" srcset="/img/loading.gif" lazyload style="zoom:67%;">

<h4 id="自定义tabBar"><a href="#自定义tabBar" class="headerlink" title="自定义tabBar"></a><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/ability/custom-tabbar.html">自定义tabBar</a></h4><h5 id="使用流程"><a href="#使用流程" class="headerlink" title="使用流程"></a>使用流程</h5><h6 id="1-配置信息"><a href="#1-配置信息" class="headerlink" title="1. 配置信息"></a>1. 配置信息</h6><ul>
<li>在 <code>app.json</code> 中的 <code>tabBar</code> 项指定 <code>custom</code> 字段，同时其余 <code>tabBar</code> 相关配置也补充完整。</li>
<li>所有 tab 页的 json 里需声明 <code>usingComponents</code> 项，也可以在 <code>app.json</code> 全局开启。</li>
</ul>
<p>示例：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;tabBar&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;custom&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;color&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;#000000&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;selectedColor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;#000000&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;backgroundColor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;#000000&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;list&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;pagePath&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;page/component/index&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;组件&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;pagePath&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;page/API/index&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;接口&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;usingComponents&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h6 id="2-添加-tabBar-代码文件"><a href="#2-添加-tabBar-代码文件" class="headerlink" title="2. 添加 tabBar 代码文件"></a>2. 添加 tabBar 代码文件</h6><p>在代码根目录下添加入口文件:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">custom-tab-bar/index.js<br>custom-tab-bar/index.json<br>custom-tab-bar/index.wxml<br>custom-tab-bar/index.wxss<br></code></pre></td></tr></table></figure>

<p>######3. 编写 tabBar 代码</p>
<p>用自定义组件的方式编写即可，该自定义组件完全接管 tabBar 的渲染。另外，自定义组件新增 <code>getTabBar</code> 接口，可获取当前页面下的自定义 tabBar 组件实例。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%8A%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/" class="category-chain-item">计算机及嵌入式软件</a>
  
  
    <span>></span>
    
  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%8A%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%89%8D%E7%AB%AF/" class="category-chain-item">计算机前端</a>
  
  
    <span>></span>
    
  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%8A%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%89%8D%E7%AB%AF/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" class="category-chain-item">微信小程序</a>
  
  

  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/">#微信小程序</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>微信小程序笔记 (7.微信小程序基础加强)</div>
      <div>https://www.duruofu.xyz/2023/06/06/3.软件相关/计算机前端/微信小程序/07.小程序 - 基础加强/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>DuRuofu</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年6月6日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2024年1月5日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - 非商业性使用">
                    <i class="iconfont icon-nc"></i>
                  </span>
                </a>
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - 相同方式共享">
                    <i class="iconfont icon-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/06/06/3.%E8%BD%AF%E4%BB%B6%E7%9B%B8%E5%85%B3/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%89%8D%E7%AB%AF/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/06.%E5%B0%8F%E7%A8%8B%E5%BA%8F%20-%20%E8%A7%86%E5%9B%BE%E4%B8%8E%E9%80%BB%E8%BE%91/" title="微信小程序笔记 (6.微信小程序视图与逻辑)">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">微信小程序笔记 (6.微信小程序视图与逻辑)</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/06/06/3.%E8%BD%AF%E4%BB%B6%E7%9B%B8%E5%85%B3/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/node.js/01.Nodejs%E5%9F%BA%E7%A1%80/" title="node.js笔记 (1.node.js基础)">
                        <span class="hidden-mobile">node.js笔记 (1.node.js基础)</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.8.0/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"c9ac06d5413a9d613a1e","clientSecret":"a44f5c72589eb090876cc64067db28fbfdf4747c","repo":"Blog-comments-gitalk","owner":"DuRuofu","admin":["DuRuofu"],"language":"zh-CN","labels":["Gitalk"],"perPage":15,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":false,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token"},
          {
            id: '86d8a2215bdecb34a9f32ba4fd7c11fb'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <br><span id="timeDate">天数载入中</span><span id="times">...</span><br> <span>总有读不懂的诗和到达不了的远方</span> <p>Copyright © 2023 - <span id="currentYear"></span> All Rights Reserved.</p> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      陕ICP备2022007454号
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=2022007454"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
          
          <span>陕ICP备2022007454号-1</span>
        </a>
      </span>
    
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":true,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="/cust/custom.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
